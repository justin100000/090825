<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy 4 Months, Sophia! 💖</title>
  <meta name="description" content="An interactive love letter with a playful entry quiz, floating hearts, mouse‑trail hearts, and a secret photo polaroid surprise." />
  <meta name="theme-color" content="#ff6b9e" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Caveat:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --pink:#ff6b9e; --peach:#ffb199; --soft:#ffe7ef; --ink:#342e37; --card:#ffffffcc; --shadow:0 20px 45px rgba(0,0,0,.12); --radius:22px; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink);
      background: radial-gradient(1200px 800px at 15% -10%, #ffd1dc 0%, transparent 50%),
                  radial-gradient(1000px 700px at 100% 0%, #ffd9cc 0%, transparent 55%),
                  linear-gradient(180deg, #fff 0%, #ffeef5 100%);
      overflow-x:hidden;
    }
    .wrap{max-width:900px;margin:0 auto;padding:28px}
    header.hero{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:8px;text-align:center;padding:36px 18px 18px}
    .title{font-family:Caveat,system-ui;font-size:clamp(2.2rem,6vw,4.2rem);line-height:1.08;margin:6px 0;color:#db2672}
    .card{background:var(--card);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.75);border-radius:var(--radius);box-shadow:var(--shadow)}
    .center-card{max-width:820px;margin:20px auto;padding:22px}
    .cta{display:inline-flex;align-items:center;gap:10px;border:none;background:linear-gradient(90deg,var(--pink),var(--peach));color:#fff;padding:14px 20px;border-radius:999px;font-weight:700;cursor:pointer;transition:transform .1s ease,filter .2s ease;box-shadow:0 10px 25px rgba(255,107,158,.35)}
    .cta:hover{transform:translateY(-1px)}
    .cta:active{transform:translateY(1px)}

    .letter{font-size:1.06rem;line-height:1.85;white-space:pre-wrap;min-height:220px;position:relative}
    .type-caret{position:absolute;width:2px;height:1.2em;background:var(--pink);display:inline-block;animation:blink 1s steps(1,end) infinite}
    @keyframes blink{50%{opacity:0}}

    footer{margin:30px 0 60px;text-align:center;opacity:.7}

    /* Floating hearts */
    .float-area{pointer-events:none;position:fixed;inset:0;overflow:hidden;z-index:0}
    .heart{position:absolute;font-size:14px;animation:floatUp linear forwards;opacity:.9}
    @keyframes floatUp{0%{transform:translateY(110vh) scale(.9);opacity:0}10%{opacity:1}100%{transform:translateY(-10vh) scale(1.3);opacity:0}}

    /* Overlay Quiz Gate */
    .gate{position:fixed;inset:0;display:grid;place-items:center;background:rgba(255,241,246,.92);backdrop-filter:blur(5px);z-index:50}
    .gate .box{max-width:720px}
    .gate h2{margin:0 0 8px}
    .gate p{margin:6px 0}
    .row{display:flex;gap:8px;margin-top:10px}
    input[type="password"],input[type="text"]{flex:1;padding:12px 14px;border:2px solid #ffd3e1;border-radius:12px;font-size:1rem}
    .hint{font-size:.92rem;opacity:.8;margin-top:6px}
    .progress{display:flex;gap:6px;margin-top:12px}
    .dot{width:10px;height:10px;border-radius:50%;background:#ffd3e1;border:2px solid #ff9fbd}
    .dot.on{background:var(--pink)}
    .err{color:#c6285b;font-weight:600;min-height:1.4em}

    /* notes (spammable) */
    .love-note{position:fixed;z-index:20;max-width:280px;background:linear-gradient(180deg,#fff6fb,#ffffff);border:2px dashed #ffc2d4;border-radius:16px;box-shadow:0 8px 26px rgba(0,0,0,.15);padding:14px 16px;font-size:1.15rem;font-family:Caveat,system-ui;letter-spacing:.2px}
    .pop{animation:pop .5s ease, fade 2.6s 2.1s ease forwards}
    @keyframes pop{0%{transform:scale(.9);opacity:0}60%{transform:scale(1.05);opacity:1}100%{transform:scale(1)}}
    @keyframes fade{to{opacity:0;transform:translateY(-10px)}}

    .controls{display:flex;justify-content:center;margin-top:14px}

    /* Screen shake (kept if needed elsewhere) */
    .shake { animation: shake 0.6s ease-in-out 0s 3; }
    @keyframes shake { 0%{transform:translate(0,0)} 15%{transform:translate(-6px,3px)} 30%{transform:translate(6px,-3px)} 45%{transform:translate(-5px,2px)} 60%{transform:translate(5px,-2px)} 75%{transform:translate(-4px,1px)} 100%{transform:translate(0,0)} }

    /* Photo overlay viewer */
    .photo-overlay{position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.55);backdrop-filter:blur(2px);z-index:80;animation:overlayIn .25s ease}
    @keyframes overlayIn{from{opacity:0}to{opacity:1}}
    .photo-overlay.fade-out{animation:overlayOut .2s ease forwards}
    @keyframes overlayOut{to{opacity:0}}
    .photo-frame{max-width:min(92vw, 880px);max-height:min(90vh, 86vh);background:#fff;border-radius:18px;padding:10px 10px 14px;box-shadow:0 30px 70px rgba(0,0,0,.35);display:grid;place-items:center;animation:popIn .35s cubic-bezier(.2,.8,.2,1)}
    @keyframes popIn{0%{transform:scale(.92);opacity:.3}70%{transform:scale(1.02)}100%{transform:scale(1);opacity:1}}
    .photo-frame img{max-width:100%;max-height:78vh;border-radius:12px;display:block}
    .photo-hint{font:600 .9rem Poppins,system-ui;color:#8a8891;text-align:center;margin-top:8px}

    /* Polaroid */
    .polaroid{background:#fff;border-radius:12px;padding:12px 12px 22px;box-shadow:0 25px 60px rgba(0,0,0,.35);transform:rotate(var(--tilt));}
    .polaroid-img{max-width:min(86vw,820px);max-height:68vh;border-radius:8px;display:block}
    .polaroid-cap{font:700 clamp(1.05rem,2.2vw,1.7rem) Caveat,system-ui;color:#444;text-align:center;margin-top:8px;letter-spacing:.3px}

    /* Cursor trail hearts */
    .trail-heart{position:fixed;left:0;top:0;pointer-events:none;z-index:65;will-change:transform,opacity;filter:drop-shadow(0 4px 10px rgba(0,0,0,.15))}

    /* ===== Anniversary celebration overlay ===== */
    .celebrate-overlay{position:fixed;inset:0;display:grid;place-items:center;background:radial-gradient(1200px 800px at 50% -10%, rgba(255,209,220,.85), rgba(0,0,0,.55));backdrop-filter:blur(2px);z-index:120}
    .celebrate-card{padding:28px 34px;border-radius:24px;background:#fff;box-shadow:0 30px 90px rgba(0,0,0,.35);text-align:center;animation:popIn .35s cubic-bezier(.2,.8,.2,1)}
    .celebrate-title{font-family:Caveat,system-ui;font-size:clamp(2.6rem,7vw,5rem);color:#db2672;margin:0 0 6px}
    .celebrate-sub{font:700 1rem Poppins,system-ui;color:#8a8891;margin:0 0 10px}
    .celebrate-hint{font:600 .9rem Poppins,system-ui;color:#8a8891;margin-top:10px}
  </style>
</head>
<body>
  <div class="float-area" id="float-area" aria-hidden="true"></div>

  <!-- QUIZ GATE -->
  <div class="gate" id="gate">
    <div class="box card" style="padding:22px">
      <h2 class="title" style="margin-bottom:4px">FINAL EXAM (this is worth 90% your grade)</h2>
      <p>3 Questions... Good luck..........</p>

      <div id="q1" class="q">
        <p style="margin:10px 0 6px"><b>1) First password</b></p>
        <div class="row"><input id="in1" type="password" placeholder="Type here…" autocomplete="off" /><button class="cta" id="btn1">Unlock 1</button></div>
        <div class="hint">Hint: <i>im+(my middle name)+inlovewithyou</i></div>
      </div>

      <div id="q2" class="q" style="display:none">
        <p style="margin:14px 0 6px"><b>2) Second password</b></p>
        <div class="row"><input id="in2" type="password" placeholder="Type here…" autocomplete="off" /><button class="cta" id="btn2">Unlock 2</button></div>
        <div class="hint">Hint: <i>(what bug is on your wrist)</i></div>
      </div>

      <div id="q3" class="q" style="display:none">
        <p style="margin:14px 0 6px"><b>3) Third password</b></p>
        <div class="row"><input id="in3" type="password" placeholder="Type here…" autocomplete="off" /><button class="cta" id="btn3">Enter 💖</button></div>
        <div class="hint">Hint: <i>(name of your bear)</i></div>
      </div>

      <div class="err" id="err"></div>
      <div class="progress"><span class="dot on" id="d1"></span><span class="dot" id="d2"></span><span class="dot" id="d3"></span></div>
    </div>
  </div>

  <div class="wrap">
    <header class="hero">
      <h1 class="title" id="main-title">Happy 4 Months, Sophia! 💖</h1>
      <div class="center-card card" id="letter-card">
        <div class="letter" id="letter"></div>
        <div class="controls"><button class="cta" id="love-btn">My Reasons Why (spam me!)</button></div>
      </div>
    </header>

    <footer>
      try typing in today's date on your keyboard
    </footer>
  </div>

  <script>
    // ===== Letter =====
    const NAME = 'Sophia';
    const FROM = 'Justin';
    const MONTHS = 4;
    const DATE_STR = 'September 9, 2025';

    // Dynamic photo list loader
    let IMGS = [];
    async function ensurePhotoList(){
      if (IMGS?.length) return IMGS;
      try {
        const res = await fetch('photos/index.json', { cache: 'no-store' });
        if (res.ok) {
          const arr = await res.json();
          if (Array.isArray(arr) && arr.length) { IMGS = arr; return IMGS; }
        }
      } catch (_) {}
      try {
        const raw = localStorage.getItem('photoList');
        if (raw) {
          try { const arr = JSON.parse(raw); if (Array.isArray(arr)) IMGS = arr; }
          catch { IMGS = raw.split(/\r?\n/).map(s=>s.trim()).filter(Boolean); }
          if (IMGS.length) return IMGS;
        }
      } catch(_) {}
      IMGS = ['photos/IMG_3097.JPG'];
      return IMGS;
    }

    const letterText = `Hi Sophia!

4 months!!!!!! THAT IS A THIRD OF A YEAR. Sometimes it feels like we just started dating yesterday, and sometimes it feels like you've always been this instrumental part of my life that I’ve always depended on. You said that you had come to depend on me one time and I was kind of confused. And then come some time, I left to college, and I started to realize how deeply I depended on you.
I’m sure you remember when I hated that Life of Pi quote. (Yes I’m still on that…) About being changed so deeply that we're not the same afterwards. 4 months in and I can tell you, I was right to put that book down. Not because the quote was wrong, but more so because I needed to live it with you before I could understand it. I know it hasn’t been long, but it’s felt like an eternity without you. I’m not the same person who wrote you that letter just one month ago. But here's what I've learned so far with my time away: the person I'm becoming, the one you're helping shape with your patience and love, is someone I actually like. Someone I'm proud to be.
Long distance has taught me things I didn't expect to learn. Yes, I miss our graeters runs (you have no idea how much (even though they were cursed…)). I miss threatening you with runs you know I'll never actually make you do. I miss being able to drive to you when either of us needs it. I miss your touch. I miss everything about you. I miss your dogs too actually… But. I think that missing you has become its own kind of connection. I think you said this earlier, but I am learning this now. Every text, every call, every moment we have even with the distance. They all mean more because we're choosing each other even when it's not easy, when we don’t have time, when we don’t have the energy. We're proving every single day that what we have isn't built on physical proximity. It's built on everything so much deeper.
What amazes me most is that we're genuinely doing this. Together. The thing that everyone always says to not do, the thing that is supposed to be impossible. We're actually doing it. This is so insane to me. And we’re not just surviving it, but growing through it. THRIVING IN IT! (sorry let me calm down.) Every challenge, every moment of missing each other, every time we choose to be patient with eachother instead of being mad. We're building something together that not even distance can affect.
I want you to know that I notice everything. I notice how you check in on me even when you're drowning in your own work, even when you’ve got your own struggles going on. I notice how you create a space for me to be imperfect while also somehow making me want to be better. I notice how you love me in a million small ways.
The miles between us are just numbers on a map. This is what to remember: You are the first thing I think about when I wake up and the last thing I want to hear before I sleep. You are the person who makes me have the courage to keep changing, to keep growing, to keep becoming whoever I'm meant to be.
4 months in. It’s a bit early. But I'm more certain than ever, you are my person. This distance is going to be temporary, but again what we're creating is forever. I love you beyond words, beyond miles, beyond anything I thought I was capable of feeling.
Thank you for choosing me. Us. Even when it's hard. Especially when it's hard.

Yours,
Justin🌟`;

    function typewriter(el, text, speed=22){
      el.textContent = '';
      const caret = document.createElement('span');
      caret.className = 'type-caret';
      el.appendChild(caret);
      let i = 0;
      const tick = () => {
        if (i < text.length){
          const ch = text[i++];
          caret.insertAdjacentText('beforebegin', ch);
          setTimeout(tick, ch === '\n' ? 120 : speed);
        } else {
          caret.remove();
        }
      };
      tick();
    }
    function showLetter(){ typewriter(document.getElementById('letter'), letterText); }

    // ===== Floating hearts background =====
    const floatArea = document.getElementById('float-area');
    function spawnHeart(){
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = '❤️';
      const size = 12 + Math.random()*24;
      h.style.left = Math.random()*100 + 'vw';
      h.style.fontSize = size + 'px';
      h.style.animationDuration = (6 + Math.random()*6) + 's';
      floatArea.appendChild(h);
      setTimeout(()=> h.remove(), 12000);
    }
    function burstHearts(n=40){ for(let i=0;i<n;i++) setTimeout(spawnHeart, i*35); }

    // ===== Secret code =====
    const TARGET = '090925';
    let buf = '';
    addEventListener('keydown', (e)=>{
      if(!/^[0-9]$/.test(e.key)) return;
      buf += e.key;
      if(!TARGET.startsWith(buf)) buf = (e.key === TARGET[0] ? e.key : '');
      if(buf === TARGET){ showRandomPhotoOverlay(); buf=''; }
    });

    // ===== Reasons sticky notes =====
    const REASONS = [
`Your gorgeous eyes`,
`Your smile (i could stare at your smile for hours)`,
`Your voice`,
`Your passion`,
`Your empathy`,
`How you’re always there for me when I’m down`,
`Your maturity`,
`Your intelligence`,
`How you talk me through every emotion I have`,
`How you understand me so well`,
`How you always know the answer to how I feel`,
`Whenever I see 10+ notifications from you on tiktok`,
`How well you understand yourself`,
`Your eyelids`,
`Your growth`,
`Your passion for things you love. (and hate...)`,
`Your taste in music`,
`THAT LADYBUG HAIRCLIP OF YOURS`,
`That amaaaazing bracelet you have on`,
`Your crazy cats & soup progress...`,
`Your passion in mental health`,
`Your love for helping others`,
`Your selflessness`,
`Your love for thrifting`,
`Your love for cheesecake (i love cheescake....)`,
`The way you try`,
`The way you take time to reflect`,
`Your mind`,
`Your qdoba quesadilla (i need to try it so badly)`,
`Your writing`,
`The way your room is so thoughtfully decorated`,
`Your communication`,
`Idk if this counts but I love your dogs so much........`,
`Your bizzare ability to build legos so fast...`,
`The way you can take my dumb jokes`,
`Your laugh`,
`Your “rah rah rah”s`,
`That’s great vaughn….`,
`Your playlists ESPECIALLY ❤️`,
`Your kindness to strangers (trust me it never goes unnoticed)`,
`Your hugs that feel like home (even the virtual ones)`,
`Your courage to say the hard, honest thing (thank you for asking me out…)`,
`Your patience with me`,
`Your ability to bring everybody around you up`,
`Your belief in me`,
`THE SELFIES YOU TAKE WITH YOUR TONGUE STUCK OUT`,
`The dreaded “pills” alarm...`,
`That litlte super random baking competition trophy you have`,
`Your messages on couple joy`,
`The way you wait to talk to me before sleeping`,
`The way you’d give up sleep for me (i would too love i love you so much)`,
`Your compassion for your dogs`,
`Your love for your movies and shows`,
`Your honesty with me when I need advice`,
`Your gentleness with yourself (You’ve grown so much)`,
`Your accountability (you show up. always.)`,
`The handshake we made when you visited me at Vandy`,
`Your ability to always find the underground things`,
`Your “I saw this and thought of you” moments`,
`Your smell`,
`Your We’re not really strangers game you carry around everywhere`,
`Your willingness to apologize and repair things`,
`The way you feel for others`,
`Your gift giving`,
`Your willingness to learn and unlearn things`,
`Your voice memos (my prized posessions)`,
`How you love and also hate holding hands`,
`Your laughs at my worst jokes`,
`Your commitment to growth over perfection`,
`Your way of making ordinary days feel special`,
`Your faith in us`,
`Your kindness to the service workers out there (always leave a tip guys)`,
`Your memory for the small things`
    ];

    function rand(min,max){ return Math.random()*(max-min)+min; }
    function spawnNote(){
      const note = document.createElement('div');
      note.className = 'love-note pop';
      // rotate + random border color
      const bgs = ['linear-gradient(180deg,#fff6fb,#ffffff)','linear-gradient(180deg,#fffbe6,#ffffff)','linear-gradient(180deg,#eaf7ff,#ffffff)'];
      const borders = ['#ffc2d4','#ffd3a8','#bde0ff'];
      note.style.background = bgs[Math.floor(Math.random()*bgs.length)];
      note.style.borderColor = borders[Math.floor(Math.random()*borders.length)];
      note.textContent = REASONS[Math.floor(Math.random()*REASONS.length)];
      const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
      const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
      const x = rand(20, vw-300); const y = rand(80, vh-220);
      note.style.left = x+"px"; note.style.top = y+"px";
      document.body.appendChild(note);
      setTimeout(()=> note.remove(), 3600);
      burstHearts(6);
    }
    document.getElementById('love-btn').addEventListener('click', spawnNote);

    // ===== Photo overlay (polaroid) =====
    async function showRandomPhotoOverlay(){
      const list = await ensurePhotoList();
      if(!list || !list.length){
        alert('Add your photo filenames to photos/index.json or localStorage.photoList.');
        return;
      }
      if(!window.__photoPool || window.__photoPool.length === 0){ window.__photoPool = list.slice(); }
      const idx = Math.floor(Math.random()*window.__photoPool.length);
      const src = window.__photoPool.splice(idx,1)[0];

      const overlay = document.createElement('div');
      overlay.className = 'photo-overlay';

      const frame = document.createElement('div');
      frame.className = 'photo-frame';

      const polaroid = document.createElement('div');
      polaroid.className = 'polaroid';
      polaroid.style.setProperty('--tilt', (Math.random()*8-4)+'deg');

      const img = new Image();
      img.className = 'polaroid-img';
      img.alt = 'our memory photo';
      img.src = src;
      img.loading = 'eager';
      img.onerror = ()=>{ img.onerror = null; img.src = `https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/1200/800`; };

      const cap = document.createElement('div');
      cap.className = 'polaroid-cap';
      const base = (src.split('/').pop()||'').replace(/\.(jpeg|jpg|png|webp|gif)$/i,'').replace(/[-_]+/g,' ').trim();
      cap.textContent = base || 'us ♡';

      polaroid.appendChild(img);
      polaroid.appendChild(cap);
      frame.appendChild(polaroid);

      const hint = document.createElement('div');
      hint.className = 'photo-hint';
      hint.textContent = 'click anywhere or press Esc to close';
      frame.appendChild(hint);

      overlay.appendChild(frame);
      document.body.appendChild(overlay);

      function close(){ overlay.classList.add('fade-out'); setTimeout(()=> overlay.remove(), 180); }
      overlay.addEventListener('click', close);
      const onEsc = (e)=>{ if(e.key === 'Escape'){ close(); removeEventListener('keydown', onEsc); } };
      addEventListener('keydown', onEsc);
    }

    // ===== Mouse trail hearts =====
    let mouseX = null, mouseY = null, lastTrail = 0;
    function spawnTrailHeart(x, y){
      const s = document.createElement('span');
      s.className = 'trail-heart';
      s.textContent = '❤️';
      s.style.left = x + 'px';
      s.style.top = y + 'px';
      s.style.fontSize = (10 + Math.random()*16) + 'px';
      document.body.appendChild(s);
      const dx = (Math.random()*2 - 1) * 24;
      const dy = - (10 + Math.random()*30);
      const rot = (Math.random()*120 - 60);
      const dur = 600 + Math.random()*500;
      s.animate([
        { transform: 'translate(-50%,-50%) scale(1) rotate(0deg)', opacity: .95 },
        { transform: `translate(${dx}px, ${dy}px) scale(.6) rotate(${rot}deg)`, opacity: 0 }
      ], { duration: dur, easing: 'cubic-bezier(.22,.61,.36,1)', fill: 'forwards' });
      setTimeout(()=> s.remove(), dur + 80);
    }
    window.addEventListener('mousemove', (e)=>{
      mouseX = e.clientX; mouseY = e.clientY;
      const now = performance.now();
      if(now - lastTrail > 40){ spawnTrailHeart(mouseX, mouseY); lastTrail = now; }
    });

    // ===== Quiz logic =====
    const PASS1 = 'imjoeinlovewithyou';
    const PASS2 = 'ladybug';
    const PASS3 = 'bobert';

    function norm(s){
      return (s||'').toString().normalize('NFKD').toLowerCase().replace(/\s+/g,'').replace(/[^a-z0-9]/g,'');
    }

    const err = document.getElementById('err');
    const q1  = document.getElementById('q1');
    const q2  = document.getElementById('q2');
    const q3  = document.getElementById('q3');
    const d1  = document.getElementById('d1');
    const d2  = document.getElementById('d2');
    const d3  = document.getElementById('d3');

    function showQ(el){ q1.style.display='none'; q2.style.display='none'; q3.style.display='none'; el.style.display='block'; }

    function checkPass(inputId, expected, nextEl, dotEl){
      const inp = document.getElementById(inputId);
      const ok  = norm(inp.value) === norm(expected);
      if(ok){
        err.style.color = '#2e7d32';
        err.textContent = '✓ unlocked!';
        if(dotEl) dotEl.classList.add('on');
        if(nextEl){
          showQ(nextEl);
          const nextInput = nextEl.querySelector('input');
          setTimeout(()=> nextInput && nextInput.focus(), 50);
        } else {
          document.getElementById('gate').style.display = 'none';
          document.getElementById('main-title').textContent = 'HAPPY 4 MONTHS MY LOVE!';
          showLetter();
          burstHearts(36);
        }
      } else {
        err.style.color = '#c6285b';
        err.textContent = 'Close, but not quite. Try the hint!';
        inp.style.borderColor = '#ff6b9e';
        setTimeout(()=> inp.style.borderColor = '#ffd3e1', 600);
      }
    }

    document.getElementById('btn1').addEventListener('click', ()=> checkPass('in1', PASS1, q2, d2));
    document.getElementById('btn2').addEventListener('click', ()=> checkPass('in2', PASS2, q3, d3));
    document.getElementById('btn3').addEventListener('click', ()=> checkPass('in3', PASS3, null, null));

    ['in1','in2','in3'].forEach((id, i)=>{
      const btn = document.getElementById(['btn1','btn2','btn3'][i]);
      const inp = document.getElementById(id);
      inp.addEventListener('keydown', e=>{ if(e.key==='Enter'){ btn.click(); }});
    });

    // Autofocus first input on DOM ready
    window.addEventListener('DOMContentLoaded', ()=> {
      document.getElementById('in1').focus();
      showQ(q1);
      d1.classList.add('on');
      scheduleDailyCelebration(); // <— start the 10:38pm local-time celebration
    });

    // ===== 10:38pm Local-Time Celebration =====
    const CELEBRATION_HOUR = 22;   // 24h clock — 22 = 10pm
    const CELEBRATION_MIN  = 38;   // 38 minutes past the hour

    function celebrate(){
      try { localStorage.setItem('lastCelebration', new Date().toDateString()); } catch(_) {}

      const overlay = document.createElement('div');
      overlay.className = 'celebrate-overlay';

      const card = document.createElement('div');
      card.className = 'celebrate-card';

      const h1 = document.createElement('h1');
      h1.className = 'celebrate-title';
      h1.textContent = 'Happy Anniversary! 🎉';

      const sub = document.createElement('div');
      sub.className = 'celebrate-sub';
      const now = new Date();
      sub.textContent = now.toLocaleDateString(undefined, { weekday:'long', year:'numeric', month:'long', day:'numeric' });

      const hint = document.createElement('div');
      hint.className = 'celebrate-hint';
      hint.textContent = 'click anywhere or press Esc to close';

      card.appendChild(h1);
      card.appendChild(sub);
      card.appendChild(hint);
      overlay.appendChild(card);
      document.body.appendChild(overlay);

      // Party effects 🎈
      burstHearts(80);
      for (let i=0;i<8;i++) setTimeout(spawnNote, 250*i);

      function close(){ overlay.remove(); }
      overlay.addEventListener('click', close);
      const onEsc = (e)=>{ if(e.key==='Escape'){ close(); removeEventListener('keydown', onEsc); } };
      addEventListener('keydown', onEsc);
    }

    function msUntilNext(hour, minute){
      const now = new Date();
      const target = new Date(now);
      target.setHours(hour, minute, 0, 0);
      if (target <= now) target.setDate(target.getDate()+1);
      return target.getTime() - now.getTime();
    }

    function scheduleDailyCelebration(){
      // Avoid double-firing if user reloads exactly at time; show only once per day per device
      try {
        const last = localStorage.getItem('lastCelebration');
        const today = new Date().toDateString();
        if (last === today) {
          // already celebrated today; schedule for tomorrow
          setTimeout(()=>{ celebrate(); scheduleDailyCelebration(); }, msUntilNext(CELEBRATION_HOUR, CELEBRATION_MIN));
          return;
        }
      } catch(_) {}

      const delay = msUntilNext(CELEBRATION_HOUR, CELEBRATION_MIN);
      setTimeout(()=>{
        celebrate();
        scheduleDailyCelebration(); // schedule the next one (24h from now via msUntilNext)
      }, delay);
    }

    // For quick manual testing in console:
    window.forceCelebrate = celebrate;
  </script>
</body>
</html>
